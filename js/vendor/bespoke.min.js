/*! Bespoke.js v0.0.1-alpha-3 | (c) 2013 Mark Dalgleish | Licensed MIT */
(function(e,t,n,r){"use strict";var i=[],s=function(e){e=typeof e=="string"?{selector:o.selector}:e;var t=a({},o,e),r=n.querySelectorAll(t.selector)[0],s=u(r.children),f=s[0],l=function(e){return s[e]||e},c=function(e,t){return s[s.indexOf(e)+t]},p=function(e){return c(e,1)},v=function(e){return c(e,-1)},g=function(){w(p(f))},b=function(){w(v(f))},w=function(e){if(e==null)return;f=l(e),s.forEach(E),h(f,"active"),m(f,"inactive")},E=function(e,t){y(e,["before+","before-[0-9]+","after","after-[0-9]+","active"]);if(e===f)return;var n=t-s.indexOf(f),r=n>0?"after":"before";d(e,["inactive",r,r+"-"+Math.abs(n)])},S=function(e){var t=e.which||e.keyCode;t===37?b():(t===32||t===39)&&g()};w(s[0]),h(r,"parent"),h(s,"slide"),n.addEventListener("keydown",S),function(){var e,t,r=function(e){return function(t){t.preventDefault(),t.touches.length===1&&e(t.touches[0].pageX)}};n.addEventListener("touchstart",r(function(t){e=t})),n.addEventListener("touchmove",r(function(e){t=e})),n.addEventListener("touchend",function(){var n=t-e;if(Math.abs(n)<50)return;n>0?b():g()})}();var x={activate:w,next:g,prev:b};return i.push(x),x},o={selector:"article"},u=function(e){return[].slice.call(e,0)},a=function(e){return u(arguments).forEach(function(t){if(t)for(var n in t)e[n]=t[n]}),e},f=function(t){return t=t===e?t:e+"-"+t},l=function(e){return new RegExp("(\\s|^)"+e+"(\\s|$)","gi")},c=function(e,t){return l(t).test(e.className)},h=function(e,t){return r(e)&&p(e,t)||r(t)&&d(e,t)||v(e,t)},p=function(e,t){e.forEach(function(e){h(e,t)})},d=function(e,t){t.forEach(function(t){h(e,t)})},v=function(e,t){t=f(t),c(e,t)||(e.className+=(e.className?" ":"")+t)},m=function(e,t){return r(e)&&g(e,t)||r(t)&&y(e,t)||b(e,t)},g=function(e,t){e.forEach(function(e){m(e,t)})},y=function(e,t){t.forEach(function(t){m(e,t)})},b=function(e,t){t=f(t),c(e,t)&&(e.className=e.className.replace(l(t)," ").replace(/^\s+|\s+$/g,""))},w=function(e){return function(){var t=arguments;i.forEach(function(n){n[e].apply(null,t)})}};t[e]={presentations:i,defaults:o,from:s,next:w("next"),prev:w("prev"),activate:w("activate")}})("bespoke",this,this.document,Array.isArray);